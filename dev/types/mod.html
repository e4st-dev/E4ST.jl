<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Modication · E4ST.jl⚡</title><meta name="title" content="Modication · E4ST.jl⚡"/><meta property="og:title" content="Modication · E4ST.jl⚡"/><meta property="twitter:title" content="Modication · E4ST.jl⚡"/><meta name="description" content="Documentation for E4ST.jl⚡."/><meta property="og:description" content="Documentation for E4ST.jl⚡."/><meta property="twitter:description" content="Documentation for E4ST.jl⚡."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="E4ST.jl⚡ logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">E4ST.jl⚡</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../overview.html">Overview</a></li><li><span class="tocitem">Inputs</span><ul><li><a class="tocitem" href="../inputs/config.html">Config File</a></li><li><a class="tocitem" href="../inputs/data.html">Data</a></li><li><a class="tocitem" href="../inputs/bus.html">Bus Table</a></li><li><a class="tocitem" href="../inputs/gen.html">Generator Table</a></li><li><a class="tocitem" href="../inputs/branch.html">Branch Table</a></li><li><a class="tocitem" href="../inputs/hours.html">Hours Table</a></li><li><a class="tocitem" href="../inputs/load.html">Load</a></li><li><a class="tocitem" href="../inputs/af.html">Availability Factor Table</a></li><li><a class="tocitem" href="../inputs/logging.html">Logging</a></li></ul></li><li><span class="tocitem">Model</span><ul><li><a class="tocitem" href="../model/dcopf.html">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../model/formulation.html">Model Formulation</a></li></ul></li><li><span class="tocitem">Results</span><ul><li><a class="tocitem" href="../results/overview.html">Overview</a></li><li><a class="tocitem" href="../results/formulas.html">Formulas</a></li><li><a class="tocitem" href="../results/modifications.html">Results Modifications</a></li><li><a class="tocitem" href="../results/plotting.html">Plotting</a></li><li><a class="tocitem" href="../results/post-processing.html">Post-Processing</a></li></ul></li><li><span class="tocitem">Abstract Types</span><ul><li class="is-active"><a class="tocitem" href="mod.html">Modication</a></li><li><a class="tocitem" href="iterable.html">Iterable</a></li><li><a class="tocitem" href="policy.html">Policy</a></li><li><a class="tocitem" href="unit.html">Unit</a></li></ul></li><li><span class="tocitem">Modifications</span><ul><li><a class="tocitem" href="modifications/adjust.html">Arbitrary Temporal Adjustments</a></li><li><a class="tocitem" href="modifications/fuel-price.html">Endogenous Fuel Prices</a></li><li><a class="tocitem" href="modifications/reserve-requirement.html">Reserve Requirements</a></li><li><a class="tocitem" href="modifications/annual-cf-lim.html">Annual Capacity Factor Limit</a></li></ul></li><li><span class="tocitem">Technologies</span><ul><li><a class="tocitem" href="modifications/ccus.html">CO₂ Capture, Utilization &amp; Storage</a></li><li><a class="tocitem" href="modifications/dcline.html">DC Transmission Lines</a></li><li><a class="tocitem" href="modifications/storage.html">Storage</a></li><li><a class="tocitem" href="modifications/retrofits.html">Retrofits</a></li><li><a class="tocitem" href="modifications/interface-limits.html">Interface Limits</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Abstract Types</a></li><li class="is-active"><a href="mod.html">Modication</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="mod.html">Modication</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/e4st-dev/E4ST.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/e4st-dev/E4ST.jl/blob/main/docs/src/types/mod.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Modifications"><a class="docs-heading-anchor" href="#Modifications">Modifications</a><a id="Modifications-1"></a><a class="docs-heading-anchor-permalink" href="#Modifications" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="E4ST.Modification" href="#E4ST.Modification"><code>E4ST.Modification</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type Modification</code></pre><p>Modification represents an abstract type for really anything that would make changes to a model.</p><p><code>Modification</code>s represent ways to modify the behavior of E4ST.  Some possible examples of <code>Modifications</code> (not necessarily implemented) include:</p><ul><li>Scale the NG price for each year</li><li>Enforce a cap on carbon emissions in Colorado.</li><li>Adding a national CES with changing target and benchmark rate</li><li>Preventing the addition of new Nuclear Generation in PJM</li><li>Logging a custom calculated result to file</li><li>Plotting and saving a heat map of emissions by state as part of the results processing </li><li>The sky is the limit!</li></ul><p><strong>Defining a <code>Modification</code></strong></p><p>When defining a concrete <code>Modification</code> type, you should know the following.</p><ul><li>Since Modifications are specified in a YAML config file, <code>Modification</code>s must be constructed with keyword arguments.  <code>Base.@kwdef</code> may come in handy here.</li><li>All <code>Modication</code>s are paired with a name in the config file.  That name is automatically passed in as a keyword argument to the <code>Modification</code> constructor if the type has a <code>name</code> field.  The <code>name</code> will be passed in as a <code>Symbol</code>.</li></ul><p><code>Modification</code>&#39;s can modify things in up to four places, with the default behavior of the methods being to make no changes:</p><ul><li><a href="../inputs/data.html#E4ST.modify_raw_data!-Tuple{Any, Any}"><code>modify_raw_data!(mod, config, data)</code></a> - In the data preparation step, right after <a href="../inputs/data.html#E4ST.read_data_files!-Tuple{Any, Any}"><code>read_data_files!(config, data)</code></a> before setting up the data</li><li><a href="../inputs/data.html#E4ST.modify_setup_data!-Tuple{Any, Any}"><code>modify_setup_data!(mod, config, data)</code></a> - In the data preparation step, right after <a href="../inputs/data.html#E4ST.setup_data!"><code>setup_data!(config, data)</code></a> before setting up the <code>Model</code></li><li><a href="mod.html#E4ST.modify_model!-Tuple{Modification, Any, Any, Any}"><code>modify_model!(mod, config, data, model)</code></a> - In the model setup step, after setting up the DC-OPF but before optimizing</li><li><a href="mod.html#E4ST.modify_results!-Tuple{Modification, Any, Any}"><code>modify_results!(mod, config, data)</code></a> - After optimizing the model, in the results generation step</li></ul><p>Modifications get printed to YAML when the config file is saved at the beginning of a call to <code>run_e4st</code>.  If you implement a Modification for which it is undesirable to print every field, you can implement the following interface:</p><ul><li><a href="iterable.html#E4ST.fieldnames_for_yaml-Tuple{Type{&lt;:Iterable}}"><code>fieldnames_for_yaml(::Type)</code></a> - returns the desired fieldnames as a collection of <code>Symbol</code>s</li></ul><p>Modification can be given a rank which will determine the order that they are called in when modifying the model. This can be important if a mod requires information calculated in a previous mod or needs to be applied on top of another mod.  Ranks is specified by defining a method for <a href="mod.html#E4ST.mod_rank-Tuple{Type{Modification}}"><code>mod_rank(::Type{&lt;:Modification})</code></a>. The default rank is 0. Modifications that setup data and model features like <code>CCUS</code> and <code>DCLines</code> can have negative values to signify that they are called before while mods like policies would have a positive rank meaning they would modify the model after the setup mods. </p><p><strong>Specifying a <code>Modification</code> in the config file YAML</strong></p><p><code>Modifications</code> must be be specified in the config file.  They must have a type key, and keys for each other desired keyword argument in the constructor.</p><p><strong>An Example</strong></p><p>Say we want to make a Modification to change the price of natural gas based on a table in a CSV file.</p><pre><code class="language-julia hljs">using E4ST, CSV, DataFrames
struct UpdateNGPrice &lt;: Modification
    filename::String
    prices::DataFrame
end

# Define kwarg constructor
function UpdateNGPrice(; filename=nothing)
    filename === nothing &amp;&amp; error(&quot;Must provide UpdateNGPrice with a filename&quot;)
    prices = CSV.read(filename, DataFrame)
    return UpdateNGPrice(filename, prices)
end

# Make sure YAML doesn&#39;t try printing out the whole prices table
function E4ST.fieldnames_for_yaml(::Type{UpdateNGPrice})
    return (:filename,)
end

function E4ST.modify_raw_data!(mod::UpdateNGPrice, config, data)
    # update the price of natural gas from mod.prices here
end</code></pre><p>Now, to add this to the <code>mods</code> list in the config file:</p><pre><code class="language-yaml hljs">mods:
  ...                                   # other mods as needed
  update_ng_price:                      # This is the name of the mod
    type: UpdateNGPrice
    filename: &quot;C:/path/to/file.csv&quot;
  ...                                   # other mods as needed</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/e4st-dev/E4ST.jl/blob/c73112b000c01e1ff5526b35d3964c41f0450c8c/src/types/Modification.jl#L1-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="E4ST.modify_raw_data!-Tuple{Modification, Any, Any}" href="#E4ST.modify_raw_data!-Tuple{Modification, Any, Any}"><code>E4ST.modify_raw_data!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">modify_raw_data!(mod::Modification, config, data, model)</code></pre><p>Change the raw data with <code>mod</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/e4st-dev/E4ST.jl/blob/c73112b000c01e1ff5526b35d3964c41f0450c8c/src/types/Modification.jl#L104-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="E4ST.modify_setup_data!-Tuple{Modification, Any, Any}" href="#E4ST.modify_setup_data!-Tuple{Modification, Any, Any}"><code>E4ST.modify_setup_data!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">modify_setup_data!(mod::Modification, config, data, model)</code></pre><p>Change the setup data with <code>mod</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/e4st-dev/E4ST.jl/blob/c73112b000c01e1ff5526b35d3964c41f0450c8c/src/types/Modification.jl#L113-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="E4ST.modify_model!-Tuple{Modification, Any, Any, Any}" href="#E4ST.modify_model!-Tuple{Modification, Any, Any, Any}"><code>E4ST.modify_model!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">modify_model!(mod::Modification, config, data, model)</code></pre><p>Apply mod to the model, called in <code>setup_model</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/e4st-dev/E4ST.jl/blob/c73112b000c01e1ff5526b35d3964c41f0450c8c/src/types/Modification.jl#L123-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="E4ST.modify_results!-Tuple{Modification, Any, Any}" href="#E4ST.modify_results!-Tuple{Modification, Any, Any}"><code>E4ST.modify_results!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">modify_results!(mod::Modification, config, data)</code></pre><p>Gather the results from <code>mod</code> from the solved model, called in <code>parse_results!</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/e4st-dev/E4ST.jl/blob/c73112b000c01e1ff5526b35d3964c41f0450c8c/src/types/Modification.jl#L132-L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="E4ST.fieldnames_for_yaml-Tuple{Type{&lt;:Modification}}" href="#E4ST.fieldnames_for_yaml-Tuple{Type{&lt;:Modification}}"><code>E4ST.fieldnames_for_yaml</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fieldnames_for_yaml(::Type{M}) where {M&lt;:Modification}</code></pre><p>returns the fieldnames in a yaml, used for printing, modified for different types of mods </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/e4st-dev/E4ST.jl/blob/c73112b000c01e1ff5526b35d3964c41f0450c8c/src/types/Modification.jl#L141-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="E4ST.mod_rank-Tuple{Type{Modification}}" href="#E4ST.mod_rank-Tuple{Type{Modification}}"><code>E4ST.mod_rank</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mod_rank(::Type{Modification}) -&gt;</code></pre><p>Returns the rank of the Modification.  Rank is the order in which the type of mod should be applied relative to other types of mods.  Defaults to 0, where 1 would come after other mods and -1 would come before.  Ranks is defined for mod types. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/e4st-dev/E4ST.jl/blob/c73112b000c01e1ff5526b35d3964c41f0450c8c/src/types/Modification.jl#L176-L183">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../results/post-processing.html">« Post-Processing</a><a class="docs-footer-nextpage" href="iterable.html">Iterable »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.0 on <span class="colophon-date" title="Friday 6 October 2023 14:52">Friday 6 October 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
